### push-pull 算法：

$$
\begin{align}
\mathbf{x}^{(k+1)} &= A\mathbf{x}^{(k)} - \alpha \mathbf{y}^{(k)} \\
\mathbf{y}^{(k+1)} &= B\mathbf{y}^{(k)} + \mathbf{g}^{(k+1)} -\mathbf{g}^{(k)}
\end{align}
$$
Where $\mathbf{g}^{(k)}=(g^{(k)}_{1},\dots,g^{(k)}_{n})^T=(\nabla f_{1}(x^{(k)}_{1}),\dots,\nabla f_{n}(x^{(k)}_{n}))^T$, $\mathbf{y}^{(0)}=\mathbf{g}^{(0)}$. 

And we define $\mathbf{w}^{(k)} = \mathbb{1}_{n}\pi_{l}^T\mathbf{x}^{(k)},\bar{y}=\frac{1}{n}\mathbb{1}_{n}^T\mathbf{y},v_{B}^{(k)}=B^k\mathbb{1}_{n},J^{(k)}=\frac{1}{n}v_{B}^{(k+1)}\mathbb{1}_{n}^T,c^({k})=\pi_{l}^Tv_{B}^{(k)}$.

### 最开始的想法

选取$\mathbf{w}^k$作为true-parameter.

首先利用$A,B$的性质，我们有：
$$\mathbf{w}^{(k+1)} = \mathbf{w}^{(k)} - \alpha \mathbb{1}_{n}\pi_{l}^T\mathbf{y}^{(k)},\bar{y}^{(0)}=\bar{g}^{(0)}$$
我们希望去估计$\mathbf{x}^{k}-\mathbf{w}^k$

下面是初步的**尝试**：

#### 尝试（失败的尝试，可以忽略细节）
Left multiply $\mathbb{1}_{n}\pi_{l}^T$ on both side, we have:
$$
\mathbf{w}^{(k+1)} = \mathbf{w}^{(k)} - \alpha \mathbb{1}_{n}\pi_{l}^T\mathbf{y}^{(k)}
$$
Note that $A\mathbf{x}-\mathbf{w}=A\mathbf{x}-\mathbb{1}_{n}\pi_{l}^T\mathbf{x}=A\mathbf{x}-A_{\infty}\mathbf{x}=(A-A_{\infty})(\mathbf{x}-A_{\infty}\mathbf{x})=(A-\mathbb{1}_{n}\pi_{l}^T)(\mathbf{x}-\mathbf{w})$

Then we unfold the iteration:
$$
\begin{align}
\mathbf{x}^{(k+1)} - \mathbf{w}^{(k+1)} &=(A\mathbf{x}^{(k)} - \alpha \mathbf{y}^{(k)})-(\mathbf{w}^{(k)} - \alpha \mathbb{1}_{n}\pi_{l}^T\mathbf{y}^{(k)}) \\
&= A\mathbf{x}^{(k)}-\mathbf{w}^{(k)}-\alpha \mathbf{y}^{(k)}+\alpha \mathbb{1}_{n}\pi_{l}^T\mathbf{y}^{(k)} \\
& = A\mathbf{x}^{(k)}-\mathbf{w}^{(k)} -\alpha (I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k)} \\
 & = (A- \mathbf{1}_{n}\pi _{l}^T)(\mathbf{x}^{(k)} - \mathbf{w}^{(k)} )-\alpha (I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k)} 
\end{align}
$$
Then:
$$
\begin{align}
\mathbf{x}^{(k+1)} - \mathbf{w}^{(k+1)} &=(A- \mathbf{1}_{n}\pi _{l}^T)(\mathbf{x}^{(k)} - \mathbf{w}^{(k)} )-\alpha (I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k)}  \\
 & = (A- \mathbf{1}_{n}\pi _{l}^T)[(A- \mathbf{1}_{n}\pi _{l}^T)(\mathbf{x}^{(k-1)} - \mathbf{w}^{(k-1)} )-\alpha (I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k-1)} ]-\alpha (I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k)}  \\
 & = (A- \mathbf{1}_{n}\pi _{l}^T)^2(\mathbf{x}^{(k-1)} - \mathbf{w}^{(k-1)} )-\alpha (A- \mathbf{1}_{n}\pi _{l}^T)(I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k-1)} -\alpha (I_{n}-\mathbb{1}_{n}\pi_{l}^T) \mathbf{y}^{(k)}  \\
 & = \dots \\
 & =(A- \mathbf{1}_{n}\pi _{l}^T)^{k+1}(\mathbf{x}^{(0)}-\mathbf{w}^{(0)})-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)\mathbf{y}^{(k-i)}
\end{align}
$$
Since $\mathbf{x}^{(0)}=\mathbf{w}^{(0)}$ ( why? ), we have:
$$
\mathbf{x}^{(k+1)} - \mathbf{w}^{(k+1)} =-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)\mathbf{y}^{(k-i)}
$$
Using gradient tracking, we have:
$$
\begin{align}
\mathbf{x}^{(k+1)} - \mathbf{w}^{(k+1)} &=-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)\mathbf{y}^{(k-i)} \\
 & =-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)(\mathbf{y}^{(k-i)}-J^{(k-i)}\mathbf{y}^{(k-i)})-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)J^{(k-i)}\mathbf{y}^{(k-i)}  
\end{align}
$$
The first term is easy to control, considering the second term, and note that $\bar{y}=\bar{g}$, we have:
$$
\begin{align}
&-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)J^{(k-i)}\mathbf{y}^{(k-i)}   \\
=&-\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T) (\frac{1}{n} v_{B}^{(k-i+1)}\mathbb{1}_{n}^T)\mathbf{y}^{(k-i)} \\
=& -\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)  v_{B}^{(k-i+1)}\bar{y}^{(k-i)}  \\
=& -\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(v_{B}^{(k-i+1)}-\mathbb{1}_{n}\pi_{l}^Tv_{B}^{(k-i+1)})\bar{y}^{(k-i)}  \\
=& -\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(v_{B}^{(k-i+1)}-c^{(k-i+1)}\mathbb{1}_{n})\bar{y}^{(k-i)}  \\
=& -\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(v_{B}^{(k-i+1)}-c^{(k-i+1)}\mathbb{1}_{n})\bar{g}^{(k-i)} 
\end{align}
$$
So let's consider the norm of consensus error:
$$
\begin{align}
||  \mathbf{x}^{k+1}-\mathbf{w} ^{(k+1)}||_{\pi_{{l}}}&=  ||  \alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)\mathbf{y}^{(k-i)} ||  _{\pi_{l}} \\
& = ||  \alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)(\mathbf{y}^{(k-i)}-J^{(k-i)}\mathbf{y}^{(k-i)})+\alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)J^{(k-i)}\mathbf{y}^{(k-i)}   || _{\pi_{{l}}}  \\
& \leq  ||  \alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)(\mathbf{y}^{(k-i)}-J^{(k-i)}\mathbf{y}^{(k-i)}) ||_{\pi_{{l}}}+ || \alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)J^{(k-i)}\mathbf{y}^{(k-i)}     ||  _{\pi_{{l}}}   \\
& = ||  \alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(I_{n}-\mathbb{1}_{n}\pi_{l}^T)(\mathbf{y}^{(k-i)}-J^{(k-i)}\mathbf{y}^{(k-i)}) ||_{\pi_{{l}}}+ || \alpha \sum^{k}_{i=0}(A- \mathbf{1}_{n}\pi _{l}^T)^i(v_{B}^{(k-i+1)}-c^{(k-i+1)}\mathbb{1}_{n})\bar{g}^{(k-i)}     ||  _{\pi_{{l}}}  
\end{align} 
$$

> 做到这里发现做不动了，原因是：
> 对于：
> $$\mathbf{w}^{(k+1)} = \mathbf{w}^{(k)} - \alpha \mathbb{1}_{n}\pi_{l}^T\mathbf{y}^{(k)},\bar{y}^{(0)}=\bar{g}^{(0)}$$
> $\mathbb{1}_{n}\pi_{l}^T$不知道怎么去处理
### 数值实验

之后我们做了数值实验，有了下面的发现:

$||\mathbf{x}^k-\frac{1}{n} \mathbb{1}_{n} \mathbb{1}_{n}^T \mathbf{x}^k ||$ 和 $||\mathbf{x}^k-\mathbf{w}^k||$很接近，其中$\mathbf{w}^{k} = \mathbb{1}_{n}\pi_{l}^T\mathbf{x}^{k}$，且$||\mathbf{x}^k-\mathbf{w}^k||-||\mathbf{x}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k||\geq 0$

下面是选用了不同的seed的情况：（这里的norm都是F-norm）

![[Pasted image 20240219182545.png|300]]   ![[Pasted image 20240219182600.png|300]]
![[Pasted image 20240219182734.png|300]]   ![[Pasted image 20240219182809.png|300]]

这启发我们可以直接把$\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k$当做true parameter

这样的话，decent lemma**比较好证明**（和push-sum一样）

$$
\begin{align}
f(\bar{x}^{k+1})&=f\left( \frac{1}{n}\mathbb{1}_{n}^T\mathbf{x}^{k+1}\right) \\
&\leq f(\bar{x}^k) + \left\langle \nabla f(\bar{x}^k) ,\frac{1}{n}\mathbb{1}_{n}^TA\left(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\right) \mathbf{x}^{k}-\alpha\bar{g}^k \right\rangle +\frac{L}{2}||\frac{1}{n}\mathbb{1}_{n}^TA\left(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\right) \mathbf{x}^{k}-\alpha\bar{g}^k ||^2 \\
\end{align}
$$

### 新的想法


那么，回顾算法：

$$
\begin{align}
\mathbf{x}^{(k+1)} &= A\mathbf{x}^{(k)} - \alpha \mathbf{y}^{(k)} \\
\mathbf{y}^{(k+1)} &= B\mathbf{y}^{(k)} + \mathbf{g}^{(k+1)} -\mathbf{g}^{(k)}
\end{align}
$$

把第一行重新写成：
$$
\begin{align}
\mathbf{x}^{k+1} &=A\mathbf{x}^{k} +\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k- \alpha \mathbf{y}^{k}  \\
&=\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k+\left( A\mathbf{x}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k \right)- \alpha \mathbf{y}^{k}  \\
&=\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k+\left( A\mathbf{x}^{k}-\frac{1}{n}A\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k \right)- \alpha \mathbf{y}^{k} \\
&=\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k+A\underbrace{ \left( \mathbf{x}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k \right) }_{ \text{consensus error} }- \alpha \mathbf{y}^{k} 
\end{align}
$$
即
$$
\mathbf{x}^{k+1}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^{k+1}=A(\mathbf{x}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^{k})-\alpha \mathbf{y}^k+\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T(\mathbf{x}^k-\mathbf{x}^{k+1})
$$

在做一下平均，就可以用上 gradient tracking的性质：$\bar{y}^{k}=\bar{g}^{k}$，有下面的推导：
$$
\begin{align}
\bar{x}^{k+1}&=\frac{1}{n}\mathbb{1}_{n}^T\mathbf{x}^{k+1} \\
&=\frac{1}{n}\mathbb{1}_{n}^T\left[ \frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k+A \left( \mathbf{x}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k \right)- \alpha \mathbf{y}^{k}  \right] \\
&=\frac{1}{n}\mathbb{1}_{n}^T\mathbf{x}^k+\frac{1}{n}\mathbb{1}_{n}^TA\left( \mathbf{x}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k \right)-\alpha\frac{1}{n}\mathbb{1}_{n}^T\mathbf{y}^{k}   \\
&=\bar{x}^k+\frac{1}{n}\mathbb{1}_{n}^TA\left(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\right) \mathbf{x}^{k}-\alpha\bar{y}^k \\
&=\bar{x}^k+\underbrace{ \frac{1}{n}\mathbb{1}_{n}^T }_{ \text{constant} }A\left(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\right) \mathbf{x}^{k}-\alpha\underbrace{ \bar{g}^k  }_{ \text{mean-gradient} }
\end{align}
$$

定义：$R=\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T$，有：
$$
\begin{align}
A(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k=(A-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^TA)(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^TA)\mathbf{x}^k=(A-RA)(I-RA)\mathbf{x}^k
\end{align}
$$

数值实验上有如下结果：

$|| A(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k||_{F}=||A(\mathbf{x}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k)||_{F}$ 跟着cs_error一起收敛

且$||\mathbf{x}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k ||_{F}\geq||A(\mathbf{x}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k)||_{F}$

![[Pasted image 20240219192240.png|300]]   ![[Pasted image 20240219192249.png|300]]
![[Pasted image 20240219192259.png|300]]   ![[Pasted image 20240219192309.png|300]]

> 接下来要从数学上证明收敛




### 证明

> consensus

$$
\mathbf{x}^{k+1}=\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k+A\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)\mathbf{x}^{k}- \alpha \mathbf{y}^{k} 
$$
$$
\mathbb{1}_{n}\bar{x}^{k+1}=\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^{k+1}=\mathbb{1}_{n}\bar{x}^k+\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^TA\left(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\right) \mathbf{x}^{k}-\alpha\mathbb{1}_{n}\bar{g}^k
$$
结合$( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)^2= I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T$，故有

$$
\begin{align}
&\mathbf{x}^{k+1}-\mathbb{1}_{n}\bar{x}^{k+1}  \\
=& A\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)\mathbf{x}^{k}- \alpha \mathbf{y}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^TA\left(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\right) \mathbf{x}^{k}+\alpha\mathbb{1}_{n}\bar{g}^k\\
=&\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)A\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)\mathbf{x}^k -\alpha \mathbf{y}^k+\alpha \mathbb{1}_{n}\bar{g}^k\\
=&\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)A\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)\mathbf{x}^k-\alpha\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T  \right)  \mathbf{y}^k \\
=&\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)[A\left( I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T \right)\mathbf{x}^k-\alpha\mathbf{y}^k]
\end{align}
$$
> 急了，昨天好像推错了！昨天在第一步：

$$
\begin{align}
&\mathbf{x}^{k+1}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^{k+1} \\
=&\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^k+A(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k-\alpha \mathbf{y}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^{k}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^TA(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k+\alpha \frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{y}^k \\
=&A(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^TA(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k+\alpha \frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{y}^k -\alpha \mathbf{y}^k \\
=&(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)A(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k-\alpha(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{y}^k
\end{align}
$$
而不是：
$$
A(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{x}^k-\alpha(I-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T)\mathbf{y}^k
$$

考虑到$([I-R)A]^k(I-R)=(A-RA)^k(I-R)$

$$
\begin{align} 
&(I-R)\mathbf{x}^{k+1} \\
=&\mathbf{x}^{k+1}-\frac{1}{n}\mathbb{1}_{n}\mathbb{1}_{n}^T\mathbf{x}^{k+1} \\
=&(I-R)A(I-R)\mathbf{x}^k-\alpha(I-R)\mathbf{y}^k \\
=&(I-R)A[(I-R)A(I-R)\mathbf{x}^{k-1}-\alpha(I-R)\mathbf{y}^{k-1} ]-\alpha(I-R)\mathbf{y}^k \\
=&(I-R)A(I-R)A(I-R)\mathbf{x}^{k-1}-\alpha(I-R)A(I-R)\mathbf{y}^{k-1}-\alpha(I-R)\mathbf{y}^k \\
=&[(I-R)A]^{k+1}(I-R)\mathbf{x}^0-\alpha\sum_{i=0}^k  [(I-R)A]^i (I-R)\mathbf{y}^{k-i} \\
\underbrace{ = }_{ \text{just choose }\mathbf{x}^0=\mathbb{1}_{n} }&-\alpha\sum_{i=0}^k  [(I-R)A]^i (I-R)\mathbf{y}^{k-i}  \\
=
\end{align}
$$


> consensus error

由于：
$$
\begin{align}
&(A-RA)(I-R)-(I-R)(A-\mathbb{1}_{n}\pi_{l}^T)(I-R) \\
=&(I-R)(A-A+\mathbb{1}_{n}\pi_{l}^T)(I-R) \\
=&\underbrace{ (I-R)\mathbb{1}_{n}\pi_{l}^T }_{ =0 }(I-R) \\
=&0
\end{align}
$$

且
$$
\begin{align}
&(A-RA)^2(I-R)-(I-R)(A-\mathbb{1}_{n}\pi_{l}^T)^2(I-R)  \\ 
=& (A-RA)^2(I-R)-(I-R)(A^2-\mathbb{1}_{n}\pi_{l}^T)(I-R)\\
=&(I-R)[A(I-R)A-A^2+\mathbb{1}_{n}\pi_{l}^T](I-R) \\
=&(I-R)[\mathbb{1}_{n}\pi_{l}^T-ARA](I-R) \\
=&(I-R)[\mathbb{1}_{n}\pi_{l}^T-RA](I-R) \\
=&-\underbrace{ (I-R)R }_{ =0 }A(I-R) \\
=&0
\end{align}
$$
因此
$$
\begin{align}
&(A-RA)^{k+1}(I-R)-(I-R)(A-\mathbb{1}_{n}\pi_{l}^T)^{k+1}(I-R)  \\
=&(A-RA)(A-RA)^k(I-R)-(I-R)(A-\mathbb{1}_{n}\pi_{l}^T)^{k+1}(I-R) \\
=&(I-R)A(I-R)(A-\mathbb{1}_{n}\pi_{l}^T)^k(I-R)-(I-R)(A-\mathbb{1}_{n}\pi_{l}^T)^{k+1}(I-R)  \\
=&(I-R)A(I-R)(A^k-A^{k+1})(I-R) \\
=&(I-R)(A-R)(I-A)A^k(I-R) \\
=&(I-R)A(I-A)A^k(I-R) \\
=&(I-R)A(I-A)(A^k-R) \\
=&(I-R)(I-A)(A^{k+1}-R) \\
=&(I-R)(A^{k+1}-A^{k+2}) \\
=&(I-R)(I-A)A^{k+1} \\
=&(I-A)A^{k+1}
\end{align}
$$